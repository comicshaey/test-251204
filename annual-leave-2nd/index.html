<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>교육공무직 연차 유급휴가 및 미사용수당 계산기</title>
  <style>
    :root{--gap:14px}
    *{box-sizing:border-box}
    body{
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,'Malgun Gothic',sans-serif;
      line-height:1.55;
      color:#111;
      padding:20px;
      max-width:980px;
      margin:0 auto;
    }
    h1{font-size:28px;margin:0 0 12px}
    h2{font-size:20px;margin:24px 0 8px}
    .card{
      border:1px solid #e5e7eb;
      border-radius:14px;
      padding:16px;
      margin:12px 0;
      box-shadow:0 2px 8px rgba(0,0,0,.04);
    }
    label{display:block;font-weight:600;margin:8px 0 4px}
    input,select,button{font-size:15px}
    input,select{
      width:100%;
      padding:10px 12px;
      border:1px solid #cbd5e1;
      border-radius:10px;
    }
    .row{
      display:grid;
      grid-template-columns:repeat(2,minmax(0,1fr));
      gap:var(--gap);
    }
    .row3{
      display:grid;
      grid-template-columns:repeat(3,minmax(0,1fr));
      gap:var(--gap);
    }
    .muted{color:#64748b;font-size:13px}
    .btn{
      display:inline-block;
      background:#111;
      color:#fff;
      padding:10px 14px;
      border-radius:10px;
      text-decoration:none;
      border:0;
      cursor:pointer;
    }
    table{
      width:100%;
      border-collapse:collapse;
      margin-top:8px;
    }
    th,td{
      border:1px solid #e5e7eb;
      padding:8px;
      text-align:center;
    }
    th{background:#f8fafc}
    .stack{display:flex;flex-direction:column;gap:8px}
    .exitem{
      border:1px dashed #e2e8f0;
      padding:10px;
      border-radius:10px;
      margin-top:8px;
    }
    @media (max-width: 900px){
      .row,
      .row3{
        grid-template-columns:1fr;
      }
    }
  </style>

  <!-- 나이스 엑셀 서식 라이브러리 -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
<h1>교육공무직 연차 유급휴가 계산기 (나이스 서식 연동)</h1>

<!-- 1. 인적정보 및 근무형태 -->
<div class="card">
  <h2>1. 인적정보 및 근무형태</h2>
  <div class="row">
    <div>
      <label>구분</label>
      <select id="type">
        <option>상시근무자</option>
        <option>방학중 비상시근무자</option>
      </select>
    </div>
    <div>
      <label>최초 임용일</label>
      <input type="date" id="firstHire">
    </div>
  </div>
  <div class="row">
    <div>
      <label>근무지 유형</label>
      <select id="grantOrg">
        <option value="기관">기관 (1.1.일자 기준)</option>
        <option value="학교">학교 (3.1.일자 기준)</option>
      </select>
    </div>
    <div>
      <label>소속 기관명</label>
      <input type="text" id="orgName" placeholder="예: 기면초등학교">
    </div>
  </div>
  <div class="row">
    <div>
      <label>성명</label>
      <input type="text" id="empName" placeholder="예: 김수면">
    </div>
    <div>
      <label>직종</label>
      <select id="jobSelect">
        <option selected>교무행정사</option>
        <option>유치원방과후교육사</option>
        <option>장애유아지도사(유)</option>
        <option>장애유아지도사(유)(단시간)</option>
        <option>영양사</option>
        <option>기숙사생활지도원</option>
        <option>학교운동부지도자</option>
        <option>교육복지사(학교)</option>
        <option>전문상담사</option>
        <option>건강실무사(유)</option>
        <option>통학차량운전원</option>
        <option>발명실무원</option>
        <option>통학지도원(특수학교)</option>
        <option>특수교육지도사</option>
        <option>조리사</option>
        <option>조리실무사</option>
        <option>장애유아지도사(특)</option>
        <option>장애유아지도사(특)(단시간)</option>
        <option>직업지도사</option>
        <option>학교치료사</option>
        <option>초등돌봄전담사</option>
        <option>학교도서관사서</option>
        <option>학교도서관실무사</option>
        <option>건강실무사</option>
        <option>방과후전담사</option>
        <option>영양사(기숙학교)</option>
        <option>늘봄학교전담사</option>
        <option>직접 입력</option>
      </select>
    </div>
  </div>
  <div class="row">
    <div>
      <label>직종 직접 입력하기</label>
      <input type="text" id="jobCustom" placeholder="직접 입력" style="display:none">
    </div>
    <div>
      <label>연차 부여 계산 기준일</label>
      <input id="refDate" disabled>
      <div class="muted">기간 종료일의 다음날 회계연도 기준. (기관 1.1.일자/ 학교 3.1.일자)</div>
    </div>
  </div>
</div>

<!-- 2. 연차 일수 산정 대상기간 -->
<div class="card">
  <h2>2. 연차 일수 산정 대상기간</h2>
  <div class="row">
    <div><label>산정기간 시작일자</label><input type="date" id="periodStart" value="2025-03-01"></div>
    <div><label>산정기간 종료일자</label><input type="date" id="periodEnd" value="2026-02-28"></div>
  </div>
  <div class="row">
    <div><label>여름방학 시작일자</label><input type="date" id="vac1Start"></div>
    <div><label>여름방학 종료일자</label><input type="date" id="vac1End"></div>
  </div>
  <div class="row">
    <div><label>겨울방학 시작일자</label><input type="date" id="vac2Start"></div>
    <div><label>겨울방학 종료일자</label><input type="date" id="vac2End"></div>
  </div>
  <div class="row">
    <div><label>결근 시작</label><input type="date" id="absStart"></div>
    <div><label>결근 종료</label><input type="date" id="absEnd"></div>
  </div>
  <div class="row">
    <div><label>여름방학 중 출근일수</label><input type="number" id="vac1Work" value="0" min="0"></div>
    <div><label>겨울방학 중 출근일수</label><input type="number" id="vac2Work" value="0" min="0"></div>
  </div>

  <h3 style="margin-top:12px">제외기간 (여러 건 추가 가능)</h3>
  <div id="exList"></div>
  <button class="btn" id="addExBtn" type="button">행 추가</button>
  <div class="muted">제외기간 별 사유랑 일자를 입력하쇼.</div>
</div>

<!-- 3. 자동 계산 결과 -->
<div class="card">
  <h2>3. 자동 계산 결과</h2>
  <div class="row3">
    <div>
      <label>학기중 총 일수</label>
      <input id="daysSemester" disabled>
      <div class="muted">전체 기간에서 방학 일수 제외</div>
    </div>
    <div>
      <label>근무 일수</label>
      <input id="daysWorked" disabled>
      <div class="muted">근무 일수 = 학기 총 일수 - 제외사유 + 방학중 출근일수</div>
    </div>
    <div>
      <label>방학중 출근 제외일수</label>
      <input id="daysNoVacWork" disabled>
      <div class="muted">학기 총 일수에서 제외기간 차감</div>
    </div>
  </div>
  <div class="row3" style="margin-top:12px">
    <div>
      <label>기본 연차 일수</label>
      <input id="baseLeave" disabled>
    </div>
    <div>
      <label>근속연수에 따른 가산 연차</label>
      <input id="extraLeave" disabled>
      <div class="muted">= ⌊(근무연수-1)/2⌋</div>
    </div>
    <div>
      <label>근속연수 (년 단위)</label>
      <input id="years" disabled>
    </div>
  </div>

  <h2 style="margin-top:18px">4. 연차 유급휴가 일수 산정 내역</h2>
  <table>
    <thead>
      <tr>
        <th>학기 총 일수 기준</th>
        <th>달력상 총 일수 기준</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td id="ruleSemester">-</td>
        <td id="ruleCalendar">-</td>
      </tr>
    </tbody>
  </table>
</div>

<!-- 5. 나이스 근무상황 연동 + 연차 미사용수당 -->
<div class="card">
  <h2>5. 나이스 복무 사항 다운로드 서식 연동 계산기</h2>

  <label>나이스 근무상황 엑셀 업로드(.xlsx)</label>
  <input type="file" id="niceFile" accept=".xlsx,.xlsm">
  <p class="muted">
    ·나이스 복무 상황에서 다운로드한 엑셀 서식 그대로 업로드 하쇼.  <br>
  </p>

  <div class="row3">
    <div>
      <label>나이스 집계 연차 사용일수(일)</label>
      <input id="usedLeaveFromNice" disabled>
      <div class="muted">결재완결 + 미삭제 항목 중 연가신청분만 합산</div>
    </div>
    <div>
      <label>연차 유급휴가 일수(부여일수)</label>
      <input id="grantedLea간</div>
    </div>
    <div>
      <label>연차 미사용수당(원)</label>
      <input id="unusedLeavePay" disabled>
    </div>
    <div style="display:flex;align-items:flex-end;justify-content:flex-start">
      <button type="button" class="btn" id="btnNiceCalc">나이스 연차 사용일수 계산</button>
    </div>
  </div>

  <div style="margin-top:10px">
    <button type="button" class="btn" id="btnCalcUnused">미사용수당 계산</button>
  </div>
</div>

<p>
    <a class="btn" href="/" style="margin-top:10px;">메인으로 돌아가기</a>
</p>

<!-- 연차 일수 계산 로직 -->
<script src="./script.js"></script>

<footer style="text-align:center; margin-top:15px; color:#444;">
  제작자: 씩씩하고 귀여운 고주무관 · Contact: edusproutcomics@naver.com · 개인적인 토이 프로젝트입니다.
</footer>
</body>
</html>
